!function(e){e.fn.imageUpload=function(){var t=arguments,n={placeholder:"http://lorempixel.com/300/300",extensions:["gif","png","jpg","jpeg"],maxSize:10,alt:""};this.each(function(){function a(){return s.parent().hasClass("image-upload-wrap")?s.parent():(s.wrap('<span class="image-upload-wrap"></span>'),s.parent().append('<img class="image-upload-img"/>','<button type="button" class="image-upload-remove" title="Remove image">&times;</button>'))}function o(e){return window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(e):window.webkitURL?window.webkitURL.createObjectURL(e):!1}function i(e){c.push(e),n.error&&(console.error(c),n.error.apply(s,c))}function r(){return l.find(".resize-and-crop").remove(),l.append('<img class="image-upload-img"/>'),p=l.find(".image-upload-img"),p.attr("alt",n.alt),p}var s=e(this);e.extend(n,s.data()),e.each(t,function(){"object"==typeof this&&e.extend(n,this)});var c=[],l=a(),p=l.find("img"),d=l.find(".image-upload-remove");return p.attr("alt",n.alt),n.image||(n.image=n.placeholder),p.attr("src",n.image),s.on("change",function(){var t,a,c=this.value.split(".").pop().toLowerCase();return-1==e.inArray(c,n.extensions)?void i("You can only select the picture with extension "+n.extensions):(t=e(this).prop("files")[0],t.size>1024*n.maxSize*1024?void i("The file must be less than "+n.maxSize+"MB"):(a=o(t))?(l.find(".resize-and-crop").length>0&&(p=r()),p.attr("src",a),void(n.update?n.update.apply(s,[s,p]):!1)):void i("Your browser is very old!"))}),d.on("click",function(t){t.preventDefault(),l.find(".resize-and-crop").length>0&&(p=r()),p.attr("src",n.placeholder),s.wrap("<form>").closest("form").trigger("reset").children(":file").unwrap(),e(n.filename).val(""),n.remove?n.remove.apply(s,[s,p]):!1}),e.each(t,function(){return"function"==typeof this?this.apply(s,[s,p]):void 0}),s})}}(window.jQuery),function(e){e(document).on("ready",function(){function t(t){t.children(".row").each(function(t,n){e(n).find("input").each(function(){var n=e(this).attr("id").replace(/\d+/,t),a=e(this).attr("name").replace(/\d+/,t);e(this).attr("id",n),e(this).attr("name",a)})})}e(".image-upload").imageUpload(),e(document).on("click",".btn-clone",function(){var n=e(this),a=n.closest(".row").clone(!0),o=n.closest(".wrapper-for-clones-rows");a.find(".btn").addClass("btn-remove").removeClass("btn-clone").text("-"),o.append(a),t(o)}).on("click",".btn-remove",function(){var n=e(this),a=n.closest(".wrapper-for-clones-rows");n.closest(".row").remove(),t(a)})})}(jQuery);